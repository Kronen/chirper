<ui:composition template="/WEB-INF/templates/main-layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:chirper="http://java.sun.com/jsf/composite/chirper" >
    
    <ui:define name="title">#{userPage.profile.fullName}(@#{userPage.userName}) | Chirper</ui:define>
  
    <ui:define name="content">
        <h:outputStylesheet library="css" name="theme-blue.css" />
        
        <chirper:navbar profile="#{homePage.profile}" />
        
        <div class="wrapper">            
            <div class="chirp-row">
                <p:panel rendered="#{not empty userPage.profile}">
                <div class="chirp-quarter">
                    <!-- sub-menu (mentions, messages and edit profile) 
                    <ul class="mini-profile-indicators selectable_theme theme_nin">
                        <li class="userMenu-connections">
                            <a href="#" title="Mentions"><span class="messages-qtd" style="display:none;">0</span><span>Mentions</span></a>
                        </li>
                        <li class="userMenu-messages">
                            <a href="#" title="Direct Messages"><span class="messages-qtd" style="display:none;">0</span><span>Messages</span></a>
                        </li>
                    </ul>
                    -->
                    
                    <!-- PROFILE -->
                    <div class="module mini-profile">
                        <div class="mini-profile-info">
                            <div class="mini-profile-photo">                                
                                <h:graphicImage value="http://lorempixel.com/48/48/people" alt="user photo"/>                                
                            </div>
                            <p:link href="/user/#{userPage.userName}" styleClass="mini-profile-name" 
                                value="#{userPage.name}" />
                            <span class="mini-profile-view">@#{userPage.userName}</span>
                            <span id="user-location"></span>
                        </div>
                        <ul class="module profile-data">
                            <li>
                                <a href="#" class="open-profile-modal">
                                    <h:outputText value="#{userPage.profile.postCollection.size()}" styleClass="posts-count" />
                                    <span class="label">Posts</span>
                                </a>
                            </li>
                            <li>
                                <a href="#following" class="open-following-page">
                                    <h:outputText value="#{userPage.profile.followees.size()}" styleClass="followees-count"/>
                                    <span class="label">Following</span>
                                </a>
                            </li>
                            <li>
                                <a class="open-followers">
                                    <h:outputText value="#{userPage.profile.followers.size()}" styleClass="followers-count"/>
                                    <span class="label">Followers</span>
                                </a>
                            </li>
                        </ul>
                        <p:outputPanel id="buttonArea">
                            <p:panel styleClass="button-area" rendered="#{user != null and homePage.profile.id != userPage.profile.id}">
                                <h:form>
                                    <p:commandButton styleClass="button-flat" action="#{userPage.followUser}"
                                                     value="Follow" rendered="#{!userPage.followed}" update="@form"/>
                                    <p:commandButton styleClass="button-flat button-red" action="#{userPage.unfollowUser}" 
                                                     value="Unfollow" rendered="#{userPage.followed}" update="@form"/>
                                    <p:commandButton styleClass="button-flat" action="#{userPage.followUser}" 
                                                     value="Message" />
                                </h:form>
                            </p:panel>
                        </p:outputPanel>
                    </div>
                </div>

                <div class="postboard chirp-half">
                        <h2>
                            <span>Chirpboard</span>
                        </h2>

                        <h:form id="postForm">
                            <p:dataList value="#{userPage.profile.postCollection}" var="chirp" itemType="none" 
                                        styleClass="postboard-posts" paginator="true" paginatorPosition="bottom" rows="10">
                                <li id="post-template" class="module post" data-time="">
                                    <div class="post-data" data-userpost="" data-content_to_rt="" data-content_to_sigrt=""
                                         data-screen-name="" data-id="" data-text="" data-text-mentions="">
                                        <div class="post-photo"><img class="avatar" src="http://lorempixel.com/48/48/people" alt="user-photo"/></div>
                                        <div class="post-info">
                                            <p:link href="/user/#{userPage.userName}" styleClass="post-info-name" value="#{userPage.name}" />
                                            <h:outputText styleClass="post-info-tag" value="@#{chirp.author.user.userName}" />
                                            <a class="post-info-time">
                                                <h:outputText value="#{timeHandler.elapsed(chirp.pubDate)}" />
                                                <span class="post-location" data-lat="#{chirp.latitude}" data-lng="#{chirp.longitude}"></span>
                                            </a>
                                        </div>
                                        <p class="post-text"><h:outputText value="#{chirp.text}" /></p>

                                        <span class="post-expand">Expand</span>

                                        <div class="post-interactions">
                                            <span class="post-reply">Reply</span>
                                            <span class="post-propagate">Retransmit</span>
                                            <span class="post-favorite">Favorite</span>                                        
                                        </div>
                                        
                                        <div class="expanded-content">
                                            <ul class="post-stats">
                                                <li class="stat-count">
                                                        <span class="stat-count-value">55</span>
                                                        <span>Retransmits</span>
                                                </li>
                                                <li class="stat-count">
                                                        <span class="stat-count-value">7</span>
                                                        <span>Favs</span>
                                                </li>
                                                <li class="avatar-row">                                                    
                                                    <p:link href="/user/#{homePage.user.userName}" rendered="#{user != null}">
                                                       <img class="size24" src="http://lorempixel.com/48/48/people" alt="user-photo"/>
                                                       <h:outputText styleClass="user-name-tooltip" value="#{homePage.name}"/>
                                                    </p:link>
                                                </li>
                                            </ul>
                                            <p:panel styleClass="post-reply-content" rendered="#{user != null}">
                                                <div class="post-area-reply">
                                                    <textarea placeholder="Reply..."></textarea>
                                                    <div class="post-area-extras">
                                                        <span class="post-area-remaining">256</span>
                                                        <button class="undo-unicode">undo</button>
                                                        <button class="post-submit">post</button>
                                                    </div>
                                                </div>
                                            </p:panel>
                                        </div> 
                                    </div> 
                                </li> 
                            </p:dataList>
                        </h:form>
                        <p:dialog header="Dialog" widgetVar="dlg" modal="true" dynamic="true">
                            <h:outputText value="This content is loaded lazy." />
                        </p:dialog>
                </div>
                <div class="chirp-quarter">
                    <div class="module mini-profile">
                        <div style="text-align: center">Some content here</div>
                    </div>                   
                </div>
            </p:panel>
            </div>            
        </div>
              
    </ui:define>

</ui:composition>